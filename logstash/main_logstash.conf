input {
  tcp {
    port => 8001
    codec => line
  }
}

filter {
  json {
    source => "message"
    target => "message_decoded"
    ecs_compatibility => "v8"
  }
  
  json_encode {
    id => "json_encode_response"
    source => "[message_decoded][response]"
	target => "message_response"
  }
  
  json_encode {
    id => "json_encode_request"
    source => "[message_decoded][request]"
	target => "message_request"
  }
}
	

output {
  stdout {
    codec => rubydebug
  }
  
  elasticsearch {
    hosts => "elasticsearch.b07b69-dev.svc.cluster.local"
    data_stream => "true"
  }
}
